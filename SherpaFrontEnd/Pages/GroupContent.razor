@using SherpaFrontEnd.Model
@using SherpaFrontEnd.Services
@using SherpaFrontEnd.Shared.Tabs
@inject IGroupDataService GroupDataService;
@* @inject IAssessmentsDataService AssessmentsDataService; *@

@page "/groups/{GroupId:guid?}"

<h3>@Group?.Name</h3>

<TabControl>
    <TabPage Text="Members">
        <Members
            Group="@Group"
            OnUpdateGroup="@OnUpdateGroup">
        </Members>
    </TabPage>
    <TabPage Text="Surveys">
        <Surveys
            SurveyTemplates="@SurveyTemplates"
            SelectedGroupAssessments="@SelectedGroupAssessments"
            SelectedGroupId="@Group?.Id"
            Emails="@Emails"
            OnAddSurvey="@OnAddSurvey"
            OnCreateEvaluation="@OnCreateEvaluation"
            OnDeleteEvaluation="@OnDeleteEvaluation">
        </Surveys>
    </TabPage>
</TabControl>

@code {

    [Parameter]
    public Guid GroupId { get; set; } = Guid.Empty;


    protected override async Task OnInitializedAsync()
    {
        Group = await GroupDataService.GetGroup(GroupId);

    }

    [Parameter]
    public RenderFragment ChildContent { get; set; }
    
    [Parameter]
    public Group? Group { get; set; }

    [Parameter]
    public EventCallback<Group> OnUpdateGroup { get; set; }

    [Parameter]
    public List<Assessment>? SelectedGroupAssessments { get; set; }

    [Parameter]
    public List<SurveyTemplate>? SurveyTemplates { get; set; }

    [Parameter]
    public List<string>? Emails { get; set; }

    [Parameter]
    public EventCallback<Assessment> OnCreateEvaluation { get; set; }

    [Parameter]
    public EventCallback<Assessment> OnDeleteEvaluation { get; set; }

    [Parameter]
    public EventCallback<SurveyTemplate> OnAddSurvey { get; set; }
}