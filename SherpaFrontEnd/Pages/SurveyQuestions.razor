@page "/answer-survey/{surveyId:guid}/{memberId:guid}"
@using SherpaFrontEnd.Dtos
@using SherpaFrontEnd.Dtos.Survey
@using SherpaFrontEnd.Services
@inject ISurveyService SurveyService
@inject NavigationManager NavigationManager

<div>
    @if (_survey != null)
    {
        <h2>@_survey.Title</h2>
        <div>
            <p>@_survey.Description</p>
        </div>
    }
    @if (_questions != null)
    {
        <label>
            <p>
                @_questions[0].Statement[Languages.ENGLISH]
            </p>
        </label>
        @foreach (var response in _questions[0].Responses[Languages.ENGLISH])
        {
            <input type="radio" value="@response">
        }
    }
</div>


@code {

    [Parameter]
    public Guid SurveyId { get; set; }

    [Parameter]
    public Guid MemberId { get; set; }

    private SurveyWithoutQuestions? _survey;
    private List<Question>? _questions;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            _survey = await SurveyService.GetSurveyWithoutQuestionsById(SurveyId);
            _questions = await SurveyService.GetSurveyQuestionsBySurveyId(SurveyId);
        }
        catch
        {
            NavigationManager.NavigateTo(NavigationManager.BaseUri + "error");
        }
    }

}